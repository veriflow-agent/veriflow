<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Fact Checker, Bias Analyzer & Lie Detector</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç AI Content Analyzer</h1>
            <p class="subtitle">Verify facts, analyze bias, and detect deception in text</p>
        </header>

        <main>
            <!-- Mode Selection Section -->
            <section class="mode-selection-section">
                <h2>Choose Analysis Mode</h2>
                <div class="mode-tabs">
                    <button class="mode-tab active" data-mode="llm-output">
                        <span class="mode-icon">ü§ñ</span>
                        <span class="mode-label">LLM Output</span>
                        <span class="mode-desc">ChatGPT, Perplexity with sources</span>
                    </button>
                    <button class="mode-tab" data-mode="text-factcheck">
                        <span class="mode-icon">üîç</span>
                        <span class="mode-label">Full Fact-Check</span>
                        <span class="mode-desc">!!! Stub, don't use yet</span>
                    </button>
                    <button class="mode-tab" data-mode="key-claims">
                        <span class="mode-icon">üéØ</span>
                        <span class="mode-label">Key Claims</span>
                        <span class="mode-desc">Verify 2-3 main arguments</span>
                    </button>
                    <button class="mode-tab" data-mode="bias-analysis">
                        <span class="mode-icon">‚öñÔ∏è</span>
                        <span class="mode-label">Bias Analysis</span>
                        <span class="mode-desc">Detect political/ideological bias</span>
                    </button>
                    <button class="mode-tab" data-mode="lie-detection">
                        <span class="mode-icon">üïµÔ∏è</span>
                        <span class="mode-label">Lie Detection</span>
                        <span class="mode-desc">Find deception markers</span>
                    </button>
                    <button class="mode-tab" data-mode="manipulation">
                        <span class="mode-icon">üé≠</span>
                        <span class="mode-label">Manipulation</span>
                        <span class="mode-desc">Detect agenda & fact distortion</span>
                    </button>
                </div>
            </section>

            <!-- Mode Instructions -->
            <section class="mode-instructions">
                <!-- LLM Output Instructions -->
                <div id="llmOutputInstructions" class="instructions-card">
                    <h3>ü§ñ LLM Output Verification</h3>
                    <p>Verify that AI-generated content accurately interprets its cited sources.</p>
                    <div class="instructions-steps">
                        <div class="step">
                            <span class="step-number">1</span>
                            <span class="step-text">Copy output from <strong>ChatGPT</strong>, <strong>Perplexity</strong>, or other AI</span>
                        </div>
                        <div class="step">
                            <span class="step-number">2</span>
                            <span class="step-text">Paste below (include all source links)</span>
                        </div>
                        <div class="step">
                            <span class="step-number">3</span>
                            <span class="step-text">We'll check if claims match the cited sources</span>
                        </div>
                    </div>
                    <div class="instructions-note">
                        <span class="note-icon">üí°</span>
                        <span>Use <kbd>Ctrl+A</kbd> to select all, then <kbd>Ctrl+C</kbd> to copy the entire response</span>
                    </div>
                </div>

                <!-- Text Fact-Check Instructions -->
                <div id="textFactcheckInstructions" class="instructions-card" style="display: none;">
                    <h3>üîç Web Search Fact-Check</h3>
                    <p>Verify any text by searching the web for supporting evidence.</p>
                    <div class="instructions-steps">
                        <div class="step">
                            <span class="step-number">1</span>
                            <span class="step-text">Paste any text - articles, social media posts, claims</span>
                        </div>
                        <div class="step">
                            <span class="step-number">2</span>
                            <span class="step-text">We extract factual claims automatically</span>
                        </div>
                        <div class="step">
                            <span class="step-number">3</span>
                            <span class="step-text">Each claim is verified via web search</span>
                        </div>
                    </div>
                    <div class="instructions-note">
                        <span class="note-icon">‚ö†Ô∏è</span>
                        <span>This mode may take longer as it searches the web for each claim</span>
                    </div>
                </div>

                <!-- Key Claims Instructions -->
                <div id="keyClaimsInstructions" class="instructions-card" style="display: none;">
                    <h3>üéØ Key Claims Analysis</h3>
                    <p>Extract and verify the 2-3 most important claims in any text.</p>
                    <div class="instructions-steps">
                        <div class="step">
                            <span class="step-number">1</span>
                            <span class="step-text">Paste any text - articles, essays, arguments</span>
                        </div>
                        <div class="step">
                            <span class="step-number">2</span>
                            <span class="step-text">AI identifies the central thesis and key arguments</span>
                        </div>
                        <div class="step">
                            <span class="step-number">3</span>
                            <span class="step-text">Each key claim is thoroughly verified</span>
                        </div>
                    </div>
                    <div class="instructions-note">
                        <span class="note-icon">üí°</span>
                        <span>Best for long-form content where you want to verify the main points</span>
                    </div>
                </div>

                <!-- Bias Analysis Instructions -->
                <div id="biasAnalysisInstructions" class="instructions-card" style="display: none;">
                    <h3>‚öñÔ∏è Bias Analysis</h3>
                    <p>Analyze text for political, ideological, or perspective bias using dual AI models.</p>
                    <div class="instructions-steps">
                        <div class="step">
                            <span class="step-number">1</span>
                            <span class="step-text">Paste news articles, op-eds, or any content</span>
                        </div>
                        <div class="step">
                            <span class="step-number">2</span>
                            <span class="step-text">GPT-4o and Claude analyze independently</span>
                        </div>
                        <div class="step">
                            <span class="step-number">3</span>
                            <span class="step-text">Get consensus score and detailed breakdown</span>
                        </div>
                    </div>
                    <div class="instructions-note">
                        <span class="note-icon">üí°</span>
                        <span>Optionally add the publication name for context on known biases</span>
                    </div>
                </div>

                <!-- Lie Detection Instructions -->
                <div id="lieDetectionInstructions" class="instructions-card" style="display: none;">
                    <h3>üïµÔ∏è Lie Detection</h3>
                    <p>Analyze text for linguistic markers commonly associated with deception.</p>
                    <div class="instructions-steps">
                        <div class="step">
                            <span class="step-number">1</span>
                            <span class="step-text">Paste any text - interviews, statements, articles</span>
                        </div>
                        <div class="step">
                            <span class="step-number">2</span>
                            <span class="step-text">AI analyzes for deception markers</span>
                        </div>
                        <div class="step">
                            <span class="step-number">3</span>
                            <span class="step-text">Get risk assessment and detailed explanation</span>
                        </div>
                    </div>
                    <div class="instructions-note">
                        <span class="note-icon">‚ö†Ô∏è</span>
                        <span>This is linguistic analysis only - not a definitive truth detector</span>
                    </div>
                </div>

                <!-- Manipulation Detection Instructions -->
                <div id="manipulationInstructions" class="instructions-card" style="display: none;">
                    <h3>üé≠ Opinion Manipulation Detection</h3>
                    <p>Analyze articles for agenda-driven fact manipulation and distortion.</p>
                    <div class="instructions-steps">
                        <div class="step">
                            <span class="step-number">1</span>
                            <span class="step-text">Paste any news article or opinion piece</span>
                        </div>
                        <div class="step">
                            <span class="step-number">2</span>
                            <span class="step-text">We detect the <strong>political agenda</strong> and extract key facts</span>
                        </div>
                        <div class="step">
                            <span class="step-number">3</span>
                            <span class="step-text">Each fact is <strong>verified</strong> via web search</span>
                        </div>
                        <div class="step">
                            <span class="step-number">4</span>
                            <span class="step-text">We analyze <strong>how facts are manipulated</strong> to serve the agenda</span>
                        </div>
                    </div>
                    <div class="instructions-note">
                        <span class="note-icon">üîç</span>
                        <span>Detects: cherry-picking, omission, misrepresentation, false equivalence, emotional manipulation</span>
                    </div>
                </div>
            </section>

            <!-- Input Section -->
            <section class="input-section">
                <div class="section-header">
                    <h2 id="inputSectionTitle">Paste LLM Output with Sources</h2>
                    <p class="help-text" id="inputHelpText">Paste ChatGPT, Perplexity, or any LLM output with source links</p>
                </div>

                <!-- URL Input Field (visible in all modes) -->
                <div class="url-input-field" id="urlInputField">
                    <div class="url-input-wrapper">
                        <span class="url-icon">üîó</span>
                        <input 
                            type="url" 
                            id="articleUrl" 
                            placeholder="Or paste an article URL to analyze..."
                            autocomplete="off"
                        >
                        <button type="button" id="fetchUrlBtn" class="btn-fetch" disabled>
                            <span class="fetch-icon">üì•</span>
                            <span class="fetch-text">Fetch</span>
                        </button>
                    </div>
                    <p class="url-help-text">Enter a URL to automatically fetch and analyze the article content</p>
                    <div id="urlFetchStatus" class="url-fetch-status" style="display: none;">
                        <span class="status-icon">‚è≥</span>
                        <span class="status-text">Fetching article...</span>
                    </div>
                </div>

                <div class="input-divider">
                    <span>OR</span>
                </div>
                
                <div class="input-wrapper">
                    <textarea id="htmlInput" placeholder="Paste content here..." rows="12"></textarea>
                </div>

                <!-- Content Format Indicator -->
                <div id="contentFormatIndicator" class="content-format-indicator" style="display: none;">
                    <span id="formatIcon">‚úÖ</span>
                    <span id="formatMessage">Detected source links</span>
                </div>

                <!-- Publication URL Field (for bias analysis with MBFC lookup) -->
                <div id="publicationField" class="publication-field" style="display: none;">
                    <label for="publicationUrl">Publication URL (Optional)</label>
                    <input 
                        type="text" 
                        id="publicationUrl" 
                        placeholder="e.g., cnn.com, foxnews.com, nytimes.com"
                    >
                    <p class="input-help">Enter the publication's domain - we'll look up bias data from Media Bias/Fact Check</p>
                </div>

                <div class="input-actions">
                    <button id="checkBtn" class="btn-primary">
                        <span class="btn-icon">üî¨</span> Analyze
                    </button>
                    <button id="clearBtn" class="btn-secondary">
                        <span class="btn-icon">üóëÔ∏è</span> Clear
                    </button>
                </div>
            </section>

            <!-- Plain Text Modal -->
            <div id="plainTextModal" class="modal" style="display: none;">
                <div class="modal-content-improved">
                    <button class="modal-close-btn" id="closeModal">&times;</button>
                    
                    <div class="modal-header">
                        <div class="modal-icon-warning">‚ö†Ô∏è</div>
                        <h3>No Source Links Detected</h3>
                        <p>This content doesn't appear to have any source links for LLM verification.</p>
                    </div>
                    
                    <div class="modal-divider"></div>
                    
                    <div class="modal-body">
                        <p class="modal-subtitle">Choose how to proceed:</p>
                        
                        <div class="modal-options-grid">
                            <button class="option-card option-factcheck" id="switchToTextMode">
                                <span class="option-card-icon">üîç</span>
                                <div class="option-card-content">
                                    <h4>Full Fact-Check</h4>
                                    <p>Verify all claims via web search</p>
                                </div>
                                <span class="option-card-arrow">‚Üí</span>
                            </button>
                            
                            <button class="option-card option-keyclaims" id="switchToKeyClaimsMode">
                                <span class="option-card-icon">üéØ</span>
                                <div class="option-card-content">
                                    <h4>Key Claims Only</h4>
                                    <p>Verify the 2-3 main arguments</p>
                                </div>
                                <span class="option-card-arrow">‚Üí</span>
                            </button>
                            
                            <button class="option-card option-bias" id="switchToBiasMode">
                                <span class="option-card-icon">‚öñÔ∏è</span>
                                <div class="option-card-content">
                                    <h4>Bias Analysis</h4>
                                    <p>Check for political/ideological bias</p>
                                </div>
                                <span class="option-card-arrow">‚Üí</span>
                            </button>
                            
                            <button class="option-card option-lie" id="switchToLieMode">
                                <span class="option-card-icon">üïµÔ∏è</span>
                                <div class="option-card-content">
                                    <h4>Lie Detection</h4>
                                    <p>Analyze for deception markers</p>
                                </div>
                                <span class="option-card-arrow">‚Üí</span>
                            </button>

                            <button class="option-card option-manipulation" id="switchToManipulationMode">
                                <span class="option-card-icon">üé≠</span>
                                <div class="option-card-content">
                                    <h4>Manipulation Detection</h4>
                                    <p>Detect agenda-driven fact distortion</p>
                                </div>
                                <span class="option-card-arrow">‚Üí</span>
                            </button>
                            
                            <button class="option-card option-continue" id="continueAnyway">
                                <span class="option-card-icon">‚è©</span>
                                <div class="option-card-content">
                                    <h4>Continue Anyway</h4>
                                    <p>Try LLM verification regardless</p>
                                </div>
                                <span class="option-card-arrow">‚Üí</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Status Section -->
            <section id="statusSection" class="status-section" style="display: none;">
                <div class="status-card">
                    <div class="status-header">
                        <div class="spinner"></div>
                        <h2>Analyzing Content...</h2>
                    </div>
                    <div id="progressLog" class="progress-log"></div>
                    <div class="status-actions">
                        <button id="stopBtn" class="btn-danger" style="display: none;">
                            <span class="btn-icon">‚èπÔ∏è</span> Stop
                        </button>
                    </div>
                </div>
            </section>

            <!-- Results Section -->
            <section id="resultsSection" class="results-section" style="display: none;">
                <!-- Result Tabs -->
                <div class="results-tabs">
                    <button id="factCheckTab" class="results-tab active" data-tab="fact-check">
                        üìã Fact Check
                    </button>
                    <button id="keyClaimsTab" class="results-tab" data-tab="key-claims" style="display: none;">
                        üéØ Key Claims
                    </button>
                    <button id="biasAnalysisTab" class="results-tab" data-tab="bias-analysis" style="display: none;">
                        ‚öñÔ∏è Bias Analysis
                    </button>
                    <button id="lieDetectionTab" class="results-tab" data-tab="lie-detection" style="display: none;">
                        üïµÔ∏è Lie Detection
                    </button>
                    <button id="manipulationTab" class="results-tab" data-tab="manipulation" style="display: none;">
                        üé≠ Manipulation
                    </button>
                </div>

                <!-- Fact Check Results (also used for LLM output and text fact-check) -->
                <div id="factCheckResults" class="results-content active">
                    <div class="summary-card">
                        <h3>Summary</h3>
                        <div class="summary-grid">
                            <div class="summary-item">
                                <span class="summary-value" id="totalFacts">0</span>
                                <span class="summary-label">Total Claims</span>
                            </div>
                            <div class="summary-item verified">
                                <span class="summary-value" id="verifiedCount">0</span>
                                <span class="summary-label">Verified</span>
                            </div>
                            <div class="summary-item partial">
                                <span class="summary-value" id="partialCount">0</span>
                                <span class="summary-label">Partial</span>
                            </div>
                            <div class="summary-item unverified">
                                <span class="summary-value" id="unverifiedCount">0</span>
                                <span class="summary-label">Issues</span>
                            </div>
                        </div>
                        <div class="pipeline-info">
                            <span class="pipeline-badge" id="pipelineBadge">LLM Output</span>
                            <span class="pipeline-desc" id="pipelineDesc">Checking interpretation of sources</span>
                        </div>
                    </div>

                    <h3>Detailed Results</h3>
                    <div id="factsList" class="facts-list"></div>

                    <div class="session-info">
                        Session ID: <code id="sessionId">-</code>
                        <span class="separator">‚Ä¢</span>
                        Processing Time: <span id="processingTime">0s</span>
                        <span class="separator" id="r2Sep" style="display: none;">‚Ä¢</span>
                        <a href="#" id="r2Link" target="_blank" style="display: none;">üìÑ View Full Report</a>
                    </div>
                </div>

                <!-- Key Claims Results -->
                <div id="keyClaimsResults" class="results-content" style="display: none;">
                    <div class="summary-card">
                        <h3>Key Claims Summary</h3>
                        <div class="summary-grid">
                            <div class="summary-item">
                                <span class="summary-value" id="kcTotalClaims">0</span>
                                <span class="summary-label">Key Claims</span>
                            </div>
                            <div class="summary-item verified">
                                <span class="summary-value" id="kcVerifiedCount">0</span>
                                <span class="summary-label">Verified</span>
                            </div>
                            <div class="summary-item partial">
                                <span class="summary-value" id="kcPartialCount">0</span>
                                <span class="summary-label">Partial</span>
                            </div>
                            <div class="summary-item unverified">
                                <span class="summary-value" id="kcUnverifiedCount">0</span>
                                <span class="summary-label">Unverified</span>
                            </div>
                        </div>
                        <div class="credibility-bar">
                            <span class="credibility-label">Overall Credibility:</span>
                            <div class="credibility-track">
                                <div id="kcCredibilityFill" class="credibility-fill" style="width: 0%;"></div>
                            </div>
                            <span id="kcCredibilityValue" class="credibility-value">0%</span>
                        </div>
                    </div>

                    <h3>Key Claims Analysis</h3>
                    <div id="keyClaimsList" class="claims-list"></div>

                    <div class="session-info">
                        Session ID: <code id="kcSessionId">-</code>
                        <span class="separator">‚Ä¢</span>
                        Processing Time: <span id="kcProcessingTime">0s</span>
                        <span class="separator" id="kcR2Sep" style="display: none;">‚Ä¢</span>
                        <a href="#" id="kcR2Link" target="_blank" style="display: none;">üìÑ View Full Report</a>
                    </div>
                </div>

                <!-- Bias Analysis Results -->
                <div id="biasAnalysisResults" class="results-content" style="display: none;">
                    <!-- Consensus Summary -->
                    <!-- Publication Profile (MBFC Data) -->
                    <div id="publicationProfileCard" class="publication-profile-card" style="display: none;">
                        <h3>üì∞ Publication Profile</h3>
                        <div class="publication-profile-content">
                            <div class="profile-header">
                                <span class="publication-name" id="profilePublicationName">-</span>
                                <span class="profile-source-badge" id="profileSourceBadge">Local</span>
                            </div>

                            <div class="profile-grid">
                                <div class="profile-item">
                                    <span class="profile-label">Political Leaning</span>
                                    <span class="profile-value" id="profilePoliticalLeaning">-</span>
                                </div>
                                <div class="profile-item">
                                    <span class="profile-label">Bias Rating</span>
                                    <span class="profile-value" id="profileBiasRating">-</span>
                                </div>
                                <div class="profile-item">
                                    <span class="profile-label">Factual Reporting</span>
                                    <span class="profile-value" id="profileFactualReporting">-</span>
                                </div>
                                <div class="profile-item">
                                    <span class="profile-label">Credibility</span>
                                    <span class="profile-value" id="profileCredibility">-</span>
                                </div>
                            </div>

                            <div class="profile-details" id="profileDetails" style="display: none;">
                                <div class="profile-item" id="profileOwnershipRow" style="display: none;">
                                    <span class="profile-label">Ownership</span>
                                    <span class="profile-value" id="profileOwnership">-</span>
                                </div>
                                <div class="profile-item" id="profileKnownBiasesRow" style="display: none;">
                                    <span class="profile-label">Known Biases</span>
                                    <span class="profile-value" id="profileKnownBiases">-</span>
                                </div>
                                <div class="profile-item" id="profileFailedFactChecksRow" style="display: none;">
                                    <span class="profile-label">Failed Fact Checks</span>
                                    <span class="profile-value warning" id="profileFailedFactChecks">-</span>
                                </div>
                            </div>

                            <div class="profile-footer" id="profileFooter" style="display: none;">
                                <a href="#" id="profileMbfcLink" target="_blank" class="mbfc-link">
                                    View on Media Bias/Fact Check ‚Üí
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="bias-consensus-card">
                        <h3>üìä Consensus Analysis</h3>
                        <div class="consensus-summary-grid">
                            <div class="consensus-item">
                                <span class="consensus-label">Bias Score</span>
                                <span class="consensus-value" id="consensusBiasScore">-</span>
                            </div>
                            <div class="consensus-item">
                                <span class="consensus-label">Direction</span>
                                <span class="consensus-value" id="consensusBiasDirection">-</span>
                            </div>
                            <div class="consensus-item">
                                <span class="consensus-label">Confidence</span>
                                <span class="consensus-value" id="biasConfidence">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Model Comparison -->
                    <div class="bias-summary-card">
                        <h3>üìä Model Analysis Comparison</h3>
                        <div class="model-tabs">
                            <button class="model-tab active" data-model="gpt">GPT-4o</button>
                            <button class="model-tab" data-model="claude">Claude</button>
                            <button class="model-tab" data-model="consensus">Consensus</button>
                        </div>
                        
                        <!-- GPT Analysis -->
                        <div id="gptAnalysis" class="model-analysis active">
                            <div id="gptBiasResults" class="model-results">
                                <div class="bias-meter">
                                    <div class="bias-spectrum">
                                        <span class="spectrum-label left">Far Left</span>
                                        <div class="spectrum-bar">
                                            <div id="gptBiasIndicator" class="bias-indicator" style="left: 50%;"></div>
                                        </div>
                                        <span class="spectrum-label right">Far Right</span>
                                    </div>
                                    <div class="bias-label" id="gptBiasLabel">Center</div>
                                </div>
                                <div class="bias-details">
                                    <div class="bias-score">
                                        <span class="score-label">Bias Score:</span>
                                        <span class="score-value" id="gptBiasScore">0</span>
                                        <span class="score-scale">(-10 to +10)</span>
                                    </div>
                                    <div class="confidence-score">
                                        <span class="score-label">Confidence:</span>
                                        <span class="score-value" id="gptConfidence">0%</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- GPT Detailed Analysis -->
                            <div class="model-detailed-analysis">
                                <h4>Overall Assessment</h4>
                                <p id="gptOverallAssessment" class="assessment-text">-</p>
                                
                                <h4>Bias Indicators Detected</h4>
                                <ul id="gptBiasIndicators" class="bias-indicators-list"></ul>
                                
                                <h4>Language Analysis</h4>
                                <p id="gptLanguageAnalysis" class="language-text">-</p>
                            </div>
                        </div>
                        
                        <!-- Claude Analysis -->
                        <div id="claudeAnalysis" class="model-analysis" style="display: none;">
                            <div id="claudeBiasResults" class="model-results">
                                <div class="bias-meter">
                                    <div class="bias-spectrum">
                                        <span class="spectrum-label left">Far Left</span>
                                        <div class="spectrum-bar">
                                            <div id="claudeBiasIndicator" class="bias-indicator" style="left: 50%;"></div>
                                        </div>
                                        <span class="spectrum-label right">Far Right</span>
                                    </div>
                                    <div class="bias-label" id="claudeBiasLabel">Center</div>
                                </div>
                                <div class="bias-details">
                                    <div class="bias-score">
                                        <span class="score-label">Bias Score:</span>
                                        <span class="score-value" id="claudeBiasScore">0</span>
                                        <span class="score-scale">(-10 to +10)</span>
                                    </div>
                                    <div class="confidence-score">
                                        <span class="score-label">Confidence:</span>
                                        <span class="score-value" id="claudeConfidence">0%</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Claude Detailed Analysis -->
                            <div class="model-detailed-analysis">
                                <h4>Overall Assessment</h4>
                                <p id="claudeOverallAssessment" class="assessment-text">-</p>
                                
                                <h4>Bias Indicators Detected</h4>
                                <ul id="claudeBiasIndicators" class="bias-indicators-list"></ul>
                                
                                <h4>Language Analysis</h4>
                                <p id="claudeLanguageAnalysis" class="language-text">-</p>
                            </div>
                        </div>
                        
                        <!-- Consensus Analysis -->
                        <div id="consensusAnalysis" class="model-analysis" style="display: none;">
                            <div class="consensus-details">
                                <div class="consensus-section">
                                    <h4>‚úÖ Areas of Agreement</h4>
                                    <ul id="areasOfAgreement" class="agreement-list"></ul>
                                </div>
                                
                                <div class="consensus-section">
                                    <h4>‚ö†Ô∏è Areas of Disagreement</h4>
                                    <ul id="areasOfDisagreement" class="disagreement-list"></ul>
                                </div>
                                
                                <div class="consensus-section">
                                    <h4>üéØ Final Assessment</h4>
                                    <p id="finalAssessment" class="final-assessment-text">-</p>
                                </div>
                                
                                <div class="consensus-section">
                                    <h4>üí° Recommendations</h4>
                                    <ul id="recommendations" class="recommendations-list"></ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bias-indicators-card">
                        <h3>üîç Bias Indicators Found</h3>
                        <div id="biasIndicatorsList" class="bias-indicators-list"></div>
                    </div>

                    <div class="session-info">
                        Session ID: <code id="biasSessionId">-</code>
                        <span class="separator">‚Ä¢</span>
                        Processing Time: <span id="biasProcessingTime">0s</span>
                    </div>
                </div>

                <!-- Lie Detection Results -->
                <div id="lieDetectionResults" class="results-content" style="display: none;">
                    <div class="lie-detection-summary">
                        <div class="lie-summary-card risk-card">
                            <h3>‚ö†Ô∏è Deception Risk</h3>
                            <div class="risk-meter">
                                <span class="risk-value" id="lieRiskLevel">-</span>
                                <span class="risk-label" id="lieRiskLabel">Unknown</span>
                            </div>
                        </div>
                        <div class="lie-summary-card credibility-card">
                            <h3>‚úÖ Credibility Score</h3>
                            <div class="credibility-meter">
                                <span class="credibility-value" id="lieCredibilityScore">0%</span>
                                <span class="credibility-label" id="lieCredibilityLabel">Unknown</span>
                            </div>
                        </div>
                    </div>

                    <div class="analysis-card">
                        <h3>üìã Overall Assessment</h3>
                        <p id="lieOverallAssessment" class="assessment-text">-</p>
                    </div>

                    <div class="analysis-card">
                        <h3>üö© Deception Markers Found</h3>
                        <div id="lieMarkersContainer" class="markers-list"></div>
                    </div>

                    <div class="analysis-card">
                        <h3>‚úÖ Positive Indicators</h3>
                        <div id="liePositiveIndicators" class="positive-indicators"></div>
                    </div>

                    <div class="analysis-card">
                        <h3>üéØ Conclusion</h3>
                        <p id="lieConclusion" class="conclusion-text">-</p>
                    </div>

                    <details class="detailed-reasoning">
                        <summary>üîç View Detailed Reasoning</summary>
                        <p id="lieDetailedReasoning" class="reasoning-text">-</p>
                    </details>

                    <div class="session-info">
                        Session ID: <code id="lieSessionId">-</code>
                        <span class="separator">‚Ä¢</span>
                        Processing Time: <span id="lieProcessingTime">0s</span>
                        <span class="separator" id="lieR2Sep" style="display: none;">‚Ä¢</span>
                        <a href="#" id="lieR2Link" target="_blank" style="display: none;">üìÑ View Full Report</a>
                    </div>
                </div>

                <!-- Manipulation Detection Results -->
                <div id="manipulationResults" class="results-content" style="display: none;">
                    <!-- Manipulation Score -->
                    <div class="manipulation-score-container">
                        <div class="score-display">
                            <span id="manipulationScore" class="manipulation-score-value">0.0</span>
                            <span class="manipulation-score-label">/ 10 Manipulation Score</span>
                        </div>
                        <div class="manipulation-score-details">
                            <p id="manipScoreJustification"></p>
                            <span id="manipConfidence"></span>
                        </div>
                    </div>

                    <!-- Article Summary -->
                    <div id="manipulationSummary" class="manipulation-summary-card">
                        <h4>üì∞ Article Analysis</h4>
                        <div class="summary-meta-row">
                            <div class="meta-item">
                                <span class="meta-label">Political Lean:</span>
                                <span id="manipPoliticalLean" class="lean-badge">-</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Content:</span>
                                <span id="manipOpinionRatio" class="ratio-value">-</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Tone:</span>
                                <span id="manipEmotionalTone">-</span>
                            </div>
                        </div>
                        <div class="summary-section">
                            <div class="summary-section-label">Main Thesis</div>
                            <div id="manipMainThesis" class="summary-section-content">-</div>
                        </div>
                        <div class="summary-section">
                            <div class="summary-section-label">Detected Agenda</div>
                            <div id="manipDetectedAgenda" class="summary-section-content">-</div>
                        </div>
                        <div class="summary-section">
                            <div class="summary-section-label">Target Audience</div>
                            <div id="manipTargetAudience" class="summary-section-content">-</div>
                        </div>
                        <div class="summary-section">
                            <div class="summary-section-label">Rhetorical Strategies</div>
                            <div id="manipRhetoricalStrategies" class="summary-section-content"></div>
                        </div>
                    </div>

                    <!-- Manipulation Techniques -->
                    <div class="techniques-section">
                        <h4>‚ö†Ô∏è Manipulation Techniques Detected</h4>
                        <div id="manipTechniquesUsed"></div>
                    </div>

                    <!-- Facts Analysis -->
                    <div class="manipulation-facts-section">
                        <h4>üîç Fact-by-Fact Analysis</h4>
                        <div id="manipFactsList"></div>
                    </div>

                    <!-- Balanced Assessment -->
                    <div class="balanced-assessment">
                        <div class="got-right-card">
                            <h4>‚úÖ What the Article Got Right</h4>
                            <div id="manipWhatGotRight"></div>
                        </div>
                        <div class="misleading-card">
                            <h4>‚ö†Ô∏è Key Misleading Elements</h4>
                            <div id="manipMisleadingElements"></div>
                        </div>
                    </div>

                    <!-- Recommendation -->
                    <div class="recommendation-card">
                        <h4>üìã Reader Recommendation</h4>
                        <p id="manipRecommendation"></p>
                    </div>

                    <!-- Session Info -->
                    <div class="session-info">
                        Session ID: <code id="manipSessionId">-</code>
                        <span class="separator">‚Ä¢</span>
                        Processing Time: <span id="manipProcessingTime">0s</span>
                        <span class="separator" id="manipR2Sep" style="display: none;">‚Ä¢</span>
                        <a href="#" id="manipR2Link" target="_blank" style="display: none;">üìÑ View Full Report</a>
                    </div>
                </div>

                <!-- Actions (shown for all tabs) -->
                <div class="results-actions">
                    <button id="exportBtn" class="btn-secondary">Export Report</button>
                    <button id="newCheckBtn" class="btn-primary">Analyze Another</button>
                </div>
            </section>

            <!-- Error Section -->
            <section id="errorSection" class="error-section" style="display: none;">
                <div class="error-box">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-content">
                        <h3>Error</h3>
                        <p id="errorMessage"></p>
                        <button id="retryBtn" class="btn-primary">Try Again</button>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>Powered by LangChain + Claude + GPT-4 ‚Ä¢ <a href="/api/health" target="_blank">Health Check</a></p>
        </footer>
    </div>

    <!-- VeriFlow Modular JavaScript -->
        <script src="{{ url_for('static', filename='js/config.js') }}"></script>
        <script src="{{ url_for('static', filename='js/utils.js') }}"></script>
        <script src="{{ url_for('static', filename='js/ui.js') }}"></script>
        <script src="{{ url_for('static', filename='js/modal.js') }}"></script>
        <script src="{{ url_for('static', filename='js/api.js') }}"></script>
        <script src="{{ url_for('static', filename='js/renderers/factcheck.js') }}"></script>
        <script src="{{ url_for('static', filename='js/renderers/keyclaims.js') }}"></script>
        <script src="{{ url_for('static', filename='js/renderers/bias.js') }}"></script>
        <script src="{{ url_for('static', filename='js/renderers/liedetection.js') }}"></script>
        <script src="{{ url_for('static', filename='js/renderers/manipulation.js') }}"></script>
        <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    </body>
    </html>