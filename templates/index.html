<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"="width=device-width, initial-scale=1.0">
    <title>AI Fact Checker, Bias Analyzer & Lie Detector</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç AI Content Analyzer</h1>
            <p class="subtitle">Verify facts, analyze bias, and detect deception in text</p>
        </header>

        <main>
            <!-- Mode Selection Section -->
            <section class="mode-selection-section">
                <h2>Choose Analysis Mode</h2>
                <div class="mode-tabs">
                    <button class="mode-tab active" data-mode="llm-output">
                        <span class="mode-icon">ü§ñ</span>
                        <span class="mode-label">LLM Output Verification</span>
                        <span class="mode-desc">ChatGPT, Perplexity, Claude with sources</span>
                    </button>
                    <button class="mode-tab" data-mode="text-factcheck">
                        <span class="mode-icon">üîç</span>
                        <span class="mode-label">Text Fact-Checking</span>
                        <span class="mode-desc">Plain text without links</span>
                    </button>
                    <button class="mode-tab" data-mode="bias-analysis">
                        <span class="mode-icon">üìä</span>
                        <span class="mode-label">Bias Analysis</span>
                        <span class="mode-desc">Detect political & ideological bias</span>
                    </button>
                    <button class="mode-tab" data-mode="lie-detection">
                        <span class="mode-icon">üïµÔ∏è</span>
                        <span class="mode-label">Lie Detection</span>
                        <span class="mode-desc">Analyze linguistic markers of deception</span>
                    </button>
                </div>
            </section>

            <!-- Input Section -->
            <section class="input-section">
                <!-- LLM Output Mode Instructions -->
                <div id="llmOutputInstructions" class="mode-instructions">
                    <div class="instructions-card">
                        <h3>üìã How to Copy LLM Output</h3>
                        <div class="instructions-steps">
                            <div class="step">
                                <span class="step-number">1</span>
                                <span class="step-text">Go to <strong>ChatGPT</strong>, <strong>Perplexity</strong>, or any LLM chat</span>
                            </div>
                            <div class="step">
                                <span class="step-number">2</span>
                                <span class="step-text">Ask a question and get a response with <strong>source citations/links</strong></span>
                            </div>
                            <div class="step">
                                <span class="step-number">3</span>
                                <span class="step-text">Select and copy the entire response (with links)</span>
                            </div>
                            <div class="step">
                                <span class="step-number">4</span>
                                <span class="step-text">Paste it below and click <strong>Analyze</strong></span>
                            </div>
                        </div>
                        <div class="instructions-note">
                            <span class="note-icon">üí°</span>
                            <span>Works with HTML, Markdown, or plain text containing URLs</span>
                        </div>
                    </div>
                </div>

                <!-- Text Fact-Check Mode Instructions -->
                <div id="textFactcheckInstructions" class="mode-instructions" style="display: none;">
                    <div class="instructions-card">
                        <h3>üîç How Text Fact-Checking Works</h3>
                        <p>This mode is for plain text without source links. The system will:</p>
                        <div class="instructions-steps">
                            <div class="step">
                                <span class="step-number">1</span>
                                <span class="step-text">Extract factual claims from your text</span>
                            </div>
                            <div class="step">
                                <span class="step-number">2</span>
                                <span class="step-text">Search the web for credible sources</span>
                            </div>
                            <div class="step">
                                <span class="step-number">3</span>
                                <span class="step-text">Verify each claim against reliable sources</span>
                            </div>
                            <div class="step">
                                <span class="step-number">4</span>
                                <span class="step-text">Provide a detailed verification report</span>
                            </div>
                        </div>
                        <div class="instructions-note">
                            <span class="note-icon">‚ö†Ô∏è</span>
                            <span>This mode uses web search and may take longer (3-5 minutes)</span>
                        </div>
                    </div>
                </div>

                <!-- Bias Analysis Mode Instructions -->
                <div id="biasAnalysisInstructions" class="mode-instructions" style="display: none;">
                    <div class="instructions-card">
                        <h3>üìä How Bias Analysis Works</h3>
                        <p>This mode analyzes text for political and ideological bias using multiple AI models:</p>
                        <div class="instructions-steps">
                            <div class="step">
                                <span class="step-number">1</span>
                                <span class="step-text">GPT-4o and Claude Sonnet analyze the text independently</span>
                            </div>
                            <div class="step">
                                <span class="step-number">2</span>
                                <span class="step-text">Both models identify bias indicators and patterns</span>
                            </div>
                            <div class="step">
                                <span class="step-number">3</span>
                                <span class="step-text">Results are combined into a consensus assessment</span>
                            </div>
                            <div class="step">
                                <span class="step-number">4</span>
                                <span class="step-text">You get a comprehensive, balanced analysis</span>
                            </div>
                        </div>
                        <div class="instructions-note">
                            <span class="note-icon">üí°</span>
                            <span>Best for news articles, op-eds, and political content</span>
                        </div>
                    </div>
                </div>

                <!-- Lie Detection Mode Instructions -->
                <div id="lieDetectionInstructions" class="mode-instructions" style="display: none;">
                    <div class="instructions-card">
                        <h3>üïµÔ∏è How Lie Detection Works</h3>
                        <p>This mode analyzes text for linguistic markers of fake news and disinformation:</p>
                        <div class="instructions-steps">
                            <div class="step">
                                <span class="step-number">1</span>
                                <span class="step-text">Analyzes <strong>word choice</strong> patterns (emotional language, certainty markers)</span>
                            </div>
                            <div class="step">
                                <span class="step-number">2</span>
                                <span class="step-text">Examines <strong>syntactic structure</strong> (sentence complexity, clickbait formatting)</span>
                            </div>
                            <div class="step">
                                <span class="step-number">3</span>
                                <span class="step-text">Detects <strong>psychological manipulation</strong> (fear appeals, conspiracy language)</span>
                            </div>
                            <div class="step">
                                <span class="step-number">4</span>
                                <span class="step-text">Evaluates <strong>source quality</strong> (attribution, citations, evidence)</span>
                            </div>
                        </div>
                        <div class="instructions-note">
                            <span class="note-icon">üí°</span>
                            <span>Analyzes HOW text is written, not whether claims are true. For fact verification, use Fact-Checking modes.</span>
                        </div>
                    </div>
                </div>

                <!-- Text Input -->
                <div class="input-group">
                    <label for="htmlInput" id="inputSectionTitle">Paste Your Content</label>
                    <p class="input-help" id="inputHelpText">Paste ChatGPT, Perplexity, or any LLM output with source links</p>
                    <textarea 
                        id="htmlInput" 
                        placeholder="Paste your content here...&#10;&#10;Examples:&#10;‚Ä¢ ChatGPT response with [citations]&#10;‚Ä¢ Perplexity answer with [1], [2] links&#10;‚Ä¢ News article text&#10;‚Ä¢ Social media post&#10;&#10;The format will be auto-detected."
                        rows="20"
                    ></textarea>
                    <div id="contentFormatIndicator" class="content-format-indicator" style="display: none;">
                        <span class="format-icon" id="formatIcon">‚úÖ</span>
                        <span class="format-message" id="formatMessage">Format detected</span>
                    </div>
                </div>

                <!-- Optional: Publication Name (only for bias analysis) -->
                <div class="input-group" id="publicationField" style="display: none;">
                    <label for="publicationName">Publication Name (Optional)</label>
                    <input 
                        type="text" 
                        id="publicationName" 
                        placeholder="e.g., The New York Times, Fox News, CNN"
                    >
                    <p class="input-help">Helps provide context for known publication biases</p>
                </div>

                <!-- Action Buttons -->
                <div class="input-actions">
                    <button id="checkBtn" class="btn-primary">
                        <span class="btn-icon">üöÄ</span>
                        Analyze
                    </button>
                    <button id="clearBtn" class="btn-secondary">
                        <span class="btn-icon">üóëÔ∏è</span>
                        Clear
                    </button>
                    <button id="stopBtn" class="btn-danger" style="display: none;" disabled>
                        <span class="btn-icon">‚èπÔ∏è</span>
                        Stop
                    </button>
                </div>
            </section>

            <!-- Plain Text Modal (for suggesting mode switch) -->
            <div id="plainTextModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <h3>‚ö†Ô∏è No Source Links Detected</h3>
                    <p>This content appears to be plain text without source links.</p>
                    <p><strong>Would you like to:</strong></p>
                    <div class="modal-buttons">
                        <button id="switchToTextMode" class="btn-primary">
                            üîç Switch to Text Fact-Checking
                            <span class="modal-btn-desc">Uses web search to verify claims</span>
                        </button>
                        <button id="switchToBiasMode" class="btn-primary">
                            üìä Switch to Bias Analysis
                            <span class="modal-btn-desc">Analyzes text for bias</span>
                        </button>
                        <button id="switchToLieMode" class="btn-primary">
                            üïµÔ∏è Switch to Lie Detection
                            <span class="modal-btn-desc">Analyzes deception markers</span>
                        </button>
                    </div>
                    <div class="modal-footer">
                        <button id="continueAnyway" class="btn-secondary-small">Continue Anyway</button>
                        <button id="closeModal" class="btn-secondary-small">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Status Section -->
            <section id="statusSection" class="status-section" style="display: none;">
                <h2>‚öôÔ∏è Processing...</h2>
                <div class="progress-container">
                    <div class="progress-log" id="progressLog"></div>
                </div>
            </section>

            <!-- Results Section -->
            <section id="resultsSection" class="results-section" style="display: none;">
                <div class="results-tabs">
                    <button class="tab-btn active" data-tab="fact-check" id="factCheckTab" style="display: none;">
                        üîç Fact Checking
                    </button>
                    <button class="tab-btn" data-tab="bias-analysis" id="biasAnalysisTab" style="display: none;">
                        üìä Bias Analysis
                    </button>
                    <button class="tab-btn" data-tab="lie-detection" id="lieDetectionTab" style="display: none;">
                        üïµÔ∏è Lie Detection
                    </button>
                </div>

                <!-- Fact Check Results Tab -->
                <div id="factCheckResults" class="tab-content active">
                    <!-- Summary Card -->
                    <div class="summary-card">
                        <h2>üìä Summary</h2>
                        <div class="summary-grid">
                            <div class="summary-item">
                                <div class="summary-label">Total Facts</div>
                                <div class="summary-value" id="totalFacts">0</div>
                            </div>
                            <div class="summary-item accurate">
                                <div class="summary-label">Accurate (‚â•0.9)</div>
                                <div class="summary-value" id="accurateFacts">0</div>
                            </div>
                            <div class="summary-item good">
                                <div class="summary-label">Good (0.7-0.9)</div>
                                <div class="summary-value" id="goodFacts">0</div>
                            </div>
                            <div class="summary-item questionable">
                                <div class="summary-label">Questionable (&lt;0.7)</div>
                                <div class="summary-value" id="questionableFacts">0</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Avg Score</div>
                                <div class="summary-value" id="avgScore">0%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Facts List -->
                    <div class="facts-list" id="factsList"></div>

                    <!-- Session Info -->
                    <div class="session-info">
                        Session ID: <code id="sessionId">-</code>
                        <span class="separator">‚Ä¢</span>
                        Processing Time: <span id="processingTime">0s</span>
                        <span class="separator">‚Ä¢</span>
                        <a href="#" id="auditLink" target="_blank" style="display: none;">üìÑ View Full Audit Report</a>
                    </div>
                </div>

                <!-- Bias Analysis Results Tab -->
                <div id="biasAnalysisResults" class="tab-content">
                    <div class="bias-summary">
                        <div class="bias-score-card">
                            <h3>Overall Bias Score</h3>
                            <div class="bias-score-value" id="consensusBiasScore">-</div>
                            <div class="bias-direction" id="consensusBiasDirection">-</div>
                        </div>
                        <div class="confidence-card">
                            <h3>Confidence Level</h3>
                            <div class="confidence-value" id="biasConfidence">-</div>
                        </div>
                    </div>

                    <!-- Model Tabs -->
                    <div class="model-tabs">
                        <button class="model-tab active" data-model="gpt">GPT-4o Analysis</button>
                        <button class="model-tab" data-model="claude">Claude Analysis</button>
                        <button class="model-tab" data-model="consensus">Consensus</button>
                    </div>

                    <!-- GPT Analysis Content -->
                    <div id="gptAnalysis" class="model-content active">
                        <div class="analysis-card">
                            <h3>üìù Overall Assessment</h3>
                            <p id="gptOverallAssessment">-</p>
                        </div>
                        <div class="analysis-card">
                            <h3>üéØ Bias Indicators</h3>
                            <ul id="gptBiasIndicators"></ul>
                        </div>
                        <div class="analysis-card">
                            <h3>üìñ Language Analysis</h3>
                            <p id="gptLanguageAnalysis">-</p>
                        </div>
                    </div>

                    <!-- Claude Analysis Content -->
                    <div id="claudeAnalysis" class="model-content">
                        <div class="analysis-card">
                            <h3>üìù Overall Assessment</h3>
                            <p id="claudeOverallAssessment">-</p>
                        </div>
                        <div class="analysis-card">
                            <h3>üéØ Bias Indicators</h3>
                            <ul id="claudeBiasIndicators"></ul>
                        </div>
                        <div class="analysis-card">
                            <h3>üìñ Language Analysis</h3>
                            <p id="claudeLanguageAnalysis">-</p>
                        </div>
                    </div>

                    <!-- Consensus Content -->
                    <div id="consensusAnalysis" class="model-content">
                        <div class="assessment-section">
                            <h3>‚úÖ Areas of Agreement</h3>
                            <ul id="areasOfAgreement"></ul>
                        </div>

                        <div class="assessment-section">
                            <h3>‚ö†Ô∏è Areas of Disagreement</h3>
                            <ul id="areasOfDisagreement"></ul>
                        </div>

                        <div class="assessment-section">
                            <h3>üéØ Final Assessment</h3>
                            <div id="finalAssessment" class="final-assessment-text"></div>
                        </div>

                        <div class="assessment-section">
                            <h3>üí° Recommendations</h3>
                            <ul id="recommendations"></ul>
                        </div>
                    </div>

                    <!-- Session Info -->
                    <div class="session-info">
                        Session ID: <code id="biasSessionId">-</code>
                        <span class="separator">‚Ä¢</span>
                        Processing Time: <span id="biasProcessingTime">0s</span>
                    </div>
                </div>

                <!-- Lie Detection Results Tab -->
                <div id="lieDetectionResults" class="tab-content">
                    <div class="lie-detection-summary">
                        <div class="risk-card">
                            <h3>Risk Level</h3>
                            <div class="risk-value" id="lieRiskLevel">-</div>
                        </div>
                        <div class="credibility-card">
                            <h3>Credibility Score</h3>
                            <div class="credibility-value" id="lieCredibilityScore">-</div>
                        </div>
                    </div>

                    <div class="analysis-card">
                        <h3>üìã Overall Assessment</h3>
                        <p id="lieOverallAssessment" class="assessment-text">-</p>
                    </div>

                    <div class="analysis-card">
                        <h3>üö® Deception Markers Detected</h3>
                        <div id="lieMarkersContainer" class="markers-container"></div>
                    </div>

                    <div class="analysis-card">
                        <h3>‚úÖ Positive Indicators</h3>
                        <div id="liePositiveIndicators" class="positive-indicators"></div>
                    </div>

                    <div class="analysis-card">
                        <h3>üéØ Conclusion</h3>
                        <p id="lieConclusion" class="conclusion-text">-</p>
                    </div>

                    <details class="detailed-reasoning">
                        <summary>üîç View Detailed Reasoning</summary>
                        <p id="lieDetailedReasoning" class="reasoning-text">-</p>
                    </details>

                    <!-- Session Info -->
                    <div class="session-info">
                        Session ID: <code id="lieSessionId">-</code>
                        <span class="separator">‚Ä¢</span>
                        Processing Time: <span id="lieProcessingTime">0s</span>
                        <span class="separator" id="lieR2Sep" style="display: none;">‚Ä¢</span>
                        <a href="#" id="lieR2Link" target="_blank" style="display: none;">üìÑ View Full Report</a>
                    </div>
                </div>

                <!-- Actions (shown for all tabs) -->
                <div class="results-actions">
                    <button id="exportBtn" class="btn-secondary">Export Report</button>
                    <button id="newCheckBtn" class="btn-primary">Analyze Another</button>
                </div>
            </section>

            <!-- Error Section -->
            <section id="errorSection" class="error-section" style="display: none;">
                <div class="error-box">
                    <div class="error-icon">‚ùå</div>
                    <div class="error-content">
                        <h3>Error</h3>
                        <p id="errorMessage"></p>
                        <button id="retryBtn" class="btn-primary">Try Again</button>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>Powered by LangChain + Claude + GPT-4 ‚Ä¢ <a href="/api/health" target="_blank">Health Check</a></p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>